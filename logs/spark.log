2025-06-27 21:35:52,429 [INFO] ✅ Spark connection created successfully.
2025-06-27 21:35:55,012 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-27 21:35:55,056 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-27 21:35:55,462 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-27 21:35:55,789 [INFO] ⚡ Streaming started with feature extraction...
2025-06-27 21:35:55,823 [INFO] Callback Server Starting
2025-06-27 21:35:55,824 [INFO] Socket listening on ('127.0.0.1', 42717)
2025-06-27 21:35:58,636 [INFO] Python Server ready to receive messages
2025-06-27 21:35:58,637 [INFO] Received command c on object id p0
2025-06-27 21:36:39,241 [INFO] Received command c on object id p0
2025-06-27 21:37:12,786 [INFO] Received command c on object id p0
2025-06-27 21:39:20,551 [INFO] Received command c on object id p0
2025-06-27 21:41:27,354 [INFO] Received command c on object id p0
2025-06-27 21:43:02,945 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-27 21:43:03,031 [INFO] Closing down clientserver connection
2025-06-27 21:43:03,033 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 21:43:03,037 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-27 21:43:03,041 [INFO] Closing down clientserver connection
2025-06-27 21:43:03,041 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 21:43:03,042 [INFO] Closing down clientserver connection
2025-06-27 21:43:03,548 [INFO] Closing down clientserver connection
2025-06-27 21:43:31,132 [INFO] ✅ Spark connection created successfully.
2025-06-27 21:43:33,808 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-27 21:43:33,849 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-27 21:43:34,135 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-27 21:43:35,733 [INFO] ⚡ Streaming started with feature extraction...
2025-06-27 21:43:35,763 [INFO] Callback Server Starting
2025-06-27 21:43:35,763 [INFO] Socket listening on ('127.0.0.1', 44765)
2025-06-27 21:43:37,777 [INFO] Python Server ready to receive messages
2025-06-27 21:43:37,778 [INFO] Received command c on object id p0
2025-06-27 21:46:00,559 [INFO] Received command c on object id p0
2025-06-27 21:46:46,232 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-27 21:46:46,254 [INFO] Closing down clientserver connection
2025-06-27 21:46:46,254 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 21:46:46,259 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-27 21:46:46,269 [INFO] Closing down clientserver connection
2025-06-27 21:46:46,269 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 21:46:46,270 [INFO] Closing down clientserver connection
2025-06-27 21:46:46,346 [INFO] Closing down clientserver connection
2025-06-27 21:47:14,921 [INFO] ✅ Spark connection created successfully.
2025-06-27 21:47:17,370 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-27 21:47:17,401 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-27 21:47:17,641 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-27 21:47:16,772 [INFO] ⚡ Streaming started with feature extraction...
2025-06-27 21:47:16,806 [INFO] Callback Server Starting
2025-06-27 21:47:16,806 [INFO] Socket listening on ('127.0.0.1', 44015)
2025-06-27 21:47:18,597 [INFO] Python Server ready to receive messages
2025-06-27 21:47:18,598 [INFO] Received command c on object id p0
2025-06-27 21:49:57,677 [INFO] Received command c on object id p0
2025-06-27 21:51:59,689 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-27 21:51:59,693 [INFO] Closing down clientserver connection
2025-06-27 21:51:59,693 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 21:51:59,695 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-27 21:51:59,699 [INFO] Closing down clientserver connection
2025-06-27 21:51:59,699 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 21:51:59,699 [INFO] Closing down clientserver connection
2025-06-27 21:51:59,744 [INFO] Closing down clientserver connection
2025-06-27 21:52:22,201 [INFO] ✅ Spark connection created successfully.
2025-06-27 21:52:24,727 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-27 21:52:24,763 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-27 21:52:25,042 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-27 21:52:25,798 [INFO] ⚡ Streaming started with feature extraction...
2025-06-27 21:52:25,827 [INFO] Callback Server Starting
2025-06-27 21:52:25,827 [INFO] Socket listening on ('127.0.0.1', 39963)
2025-06-27 21:52:26,114 [INFO] Python Server ready to receive messages
2025-06-27 21:52:26,115 [INFO] Received command c on object id p0
2025-06-27 21:56:54,109 [INFO] Received command c on object id p0
2025-06-27 22:00:15,242 [INFO] Received command c on object id p0
2025-06-27 22:01:08,489 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-27 22:01:08,586 [INFO] Closing down clientserver connection
2025-06-27 22:01:08,588 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 22:01:08,595 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-27 22:01:08,610 [INFO] Closing down clientserver connection
2025-06-27 22:01:08,610 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-27 22:01:08,611 [INFO] Closing down clientserver connection
2025-06-27 22:01:09,362 [INFO] Closing down clientserver connection
2025-06-28 00:09:38,176 [INFO] ✅ Spark connection created successfully.
2025-06-28 00:09:40,568 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-28 00:09:40,614 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-28 00:09:41,052 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-28 00:09:41,360 [INFO] ⚡ Streaming started with feature extraction...
2025-06-28 00:09:41,394 [INFO] Callback Server Starting
2025-06-28 00:09:41,394 [INFO] Socket listening on ('127.0.0.1', 44111)
2025-06-28 00:09:43,688 [INFO] Python Server ready to receive messages
2025-06-28 00:09:43,689 [INFO] Received command c on object id p0
2025-06-28 00:10:10,128 [INFO] Received command c on object id p0
2025-06-28 00:11:39,113 [INFO] Received command c on object id p0
2025-06-28 00:12:34,954 [INFO] Received command c on object id p0
2025-06-28 00:13:23,365 [INFO] Received command c on object id p0
2025-06-28 00:14:31,810 [INFO] Received command c on object id p0
2025-06-28 00:15:31,126 [INFO] Received command c on object id p0
2025-06-28 00:16:39,916 [INFO] Received command c on object id p0
2025-06-28 00:17:28,494 [INFO] Received command c on object id p0
2025-06-28 00:18:18,524 [INFO] Received command c on object id p0
2025-06-28 00:19:12,484 [INFO] Received command c on object id p0
2025-06-28 00:19:51,134 [INFO] Received command c on object id p0
2025-06-28 00:20:35,333 [INFO] Received command c on object id p0
2025-06-28 00:21:29,725 [INFO] Received command c on object id p0
2025-06-28 00:22:28,410 [INFO] Received command c on object id p0
2025-06-28 00:23:18,342 [INFO] Received command c on object id p0
2025-06-28 00:24:21,150 [INFO] Received command c on object id p0
2025-06-28 00:25:29,278 [INFO] Received command c on object id p0
2025-06-28 00:26:43,175 [INFO] Received command c on object id p0
2025-06-28 00:27:39,900 [INFO] Received command c on object id p0
2025-06-28 00:28:28,663 [INFO] Received command c on object id p0
2025-06-28 00:29:27,791 [INFO] Received command c on object id p0
2025-06-28 00:30:28,720 [INFO] Received command c on object id p0
2025-06-28 00:31:38,078 [INFO] Received command c on object id p0
2025-06-28 00:32:30,409 [INFO] Received command c on object id p0
2025-06-28 00:33:25,006 [INFO] Received command c on object id p0
2025-06-28 00:34:47,114 [INFO] Received command c on object id p0
2025-06-28 00:35:28,154 [INFO] Received command c on object id p0
2025-06-28 00:36:24,366 [INFO] Received command c on object id p0
2025-06-28 00:37:20,390 [INFO] Received command c on object id p0
2025-06-28 00:38:10,661 [INFO] Received command c on object id p0
2025-06-28 00:39:23,888 [INFO] Received command c on object id p0
2025-06-28 00:40:13,613 [INFO] Received command c on object id p0
2025-06-28 00:41:09,763 [INFO] Received command c on object id p0
2025-06-28 00:41:45,973 [INFO] Received command c on object id p0
2025-06-28 00:42:27,968 [INFO] Received command c on object id p0
2025-06-28 00:43:08,016 [INFO] Received command c on object id p0
2025-06-28 00:44:17,037 [INFO] Received command c on object id p0
2025-06-28 00:45:12,753 [INFO] Received command c on object id p0
2025-06-28 00:45:53,088 [INFO] Received command c on object id p0
2025-06-28 00:47:04,453 [INFO] Received command c on object id p0
2025-06-28 00:47:49,526 [INFO] Received command c on object id p0
2025-06-28 00:48:36,096 [INFO] Received command c on object id p0
2025-06-28 00:49:42,577 [INFO] Received command c on object id p0
2025-06-28 00:50:05,983 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-28 00:50:06,087 [INFO] Closing down clientserver connection
2025-06-28 00:50:06,089 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-28 00:50:06,094 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-28 00:50:06,101 [INFO] Closing down clientserver connection
2025-06-28 00:50:06,101 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-28 00:50:06,101 [INFO] Closing down clientserver connection
2025-06-28 00:50:06,885 [INFO] Closing down clientserver connection
2025-06-28 13:01:38,877 [INFO] ✅ Spark connection created successfully.
2025-06-28 13:01:41,114 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-28 13:01:41,151 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-28 13:01:41,477 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-28 13:01:41,826 [INFO] ⚡ Streaming started with feature extraction...
2025-06-28 13:01:41,845 [INFO] Callback Server Starting
2025-06-28 13:01:41,846 [INFO] Socket listening on ('127.0.0.1', 46051)
2025-06-28 13:01:44,553 [INFO] Python Server ready to receive messages
2025-06-28 13:01:44,553 [INFO] Received command c on object id p0
2025-06-28 13:13:40,143 [INFO] Received command c on object id p0
2025-06-28 13:14:28,211 [INFO] Received command c on object id p0
2025-06-28 13:16:50,645 [INFO] Received command c on object id p0
2025-06-28 13:19:22,761 [INFO] Received command c on object id p0
2025-06-28 13:21:32,627 [INFO] Received command c on object id p0
2025-06-28 13:24:05,676 [INFO] Received command c on object id p0
2025-06-28 13:26:14,972 [INFO] Received command c on object id p0
2025-06-28 13:28:42,615 [INFO] Received command c on object id p0
2025-06-28 13:31:00,435 [INFO] Received command c on object id p0
2025-06-28 13:33:38,770 [INFO] Received command c on object id p0
2025-06-28 13:36:30,015 [INFO] Received command c on object id p0
2025-06-28 13:38:55,679 [INFO] Received command c on object id p0
2025-06-28 15:12:50,722 [INFO] ✅ Spark connection created successfully.
2025-06-28 15:12:52,945 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-28 15:12:52,977 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-28 15:12:53,225 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-28 15:12:53,725 [INFO] ⚡ Streaming started with feature extraction...
2025-06-28 15:12:53,741 [INFO] Callback Server Starting
2025-06-28 15:12:53,744 [INFO] Socket listening on ('127.0.0.1', 46871)
2025-06-28 15:12:55,957 [INFO] Python Server ready to receive messages
2025-06-28 15:12:55,958 [INFO] Received command c on object id p0
2025-06-28 15:14:06,683 [INFO] Received command c on object id p0
2025-06-28 15:14:44,030 [INFO] Received command c on object id p0
2025-06-28 15:16:58,363 [INFO] Received command c on object id p0
2025-06-28 15:19:18,586 [INFO] Received command c on object id p0
2025-06-28 15:21:26,114 [INFO] Received command c on object id p0
2025-06-28 15:25:58,962 [WARNING] Heartbeat failed for connection (140167182767664) to 127.0.0.1:9042
2025-06-28 15:29:09,908 [WARNING] [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3577, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 855, in cassandra.connection.Connection.factory
cassandra.OperationTimedOut: errors=Timed out creating connection (5 seconds), last_host=None
2025-06-28 15:35:44,357 [INFO] ✅ Spark connection created successfully.
2025-06-28 15:35:44,114 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-28 15:35:44,145 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-28 15:35:44,366 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-28 15:35:44,411 [INFO] ⚡ Streaming started with feature extraction...
2025-06-28 15:35:44,435 [INFO] Callback Server Starting
2025-06-28 15:35:44,435 [INFO] Socket listening on ('127.0.0.1', 39957)
2025-06-28 15:37:15,448 [INFO] Python Server ready to receive messages
2025-06-28 15:37:15,450 [INFO] Received command c on object id p0
2025-06-28 15:38:53,665 [INFO] Received command c on object id p0
2025-06-28 15:39:26,660 [INFO] Received command c on object id p0
2025-06-28 15:40:12,734 [INFO] Received command c on object id p0
2025-06-28 15:41:00,141 [INFO] Received command c on object id p0
2025-06-28 15:41:42,906 [INFO] Received command c on object id p0
2025-06-28 15:42:13,715 [INFO] Received command c on object id p0
2025-06-28 15:43:07,514 [INFO] Received command c on object id p0
2025-06-28 15:43:46,162 [INFO] Received command c on object id p0
2025-06-28 15:44:21,365 [INFO] Received command c on object id p0
2025-06-28 15:44:58,206 [INFO] Received command c on object id p0
2025-06-28 15:45:37,769 [INFO] Received command c on object id p0
2025-06-28 15:46:19,062 [INFO] Received command c on object id p0
2025-06-28 15:46:57,225 [INFO] Received command c on object id p0
2025-06-28 15:47:46,514 [INFO] Received command c on object id p0
2025-06-28 15:48:31,463 [INFO] Received command c on object id p0
2025-06-28 15:50:48,338 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-28 15:50:48,369 [INFO] Closing down clientserver connection
2025-06-28 15:50:48,371 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-28 15:50:48,478 [INFO] Closing down clientserver connection
2025-06-28 15:50:48,478 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-28 15:50:48,488 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-28 15:50:48,488 [INFO] Closing down clientserver connection
2025-06-28 15:50:48,488 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-28 15:50:48,490 [INFO] Closing down clientserver connection
2025-06-30 00:47:52,519 [INFO] ✅ Spark connection created successfully.
2025-06-30 00:47:55,708 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 00:47:55,766 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 00:47:56,255 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 00:47:56,307 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 00:47:56,326 [INFO] Callback Server Starting
2025-06-30 00:47:56,327 [INFO] Socket listening on ('127.0.0.1', 40945)
2025-06-30 00:50:35,144 [INFO] Closing down clientserver connection
2025-06-30 00:52:04,629 [INFO] ✅ Spark connection created successfully.
2025-06-30 00:52:04,914 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 00:52:04,951 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 00:52:05,254 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 00:52:05,307 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 00:52:05,331 [INFO] Callback Server Starting
2025-06-30 00:52:05,332 [INFO] Socket listening on ('127.0.0.1', 46009)
2025-06-30 00:52:08,216 [INFO] Python Server ready to receive messages
2025-06-30 00:52:08,216 [INFO] Received command c on object id p0
2025-06-30 00:52:09,214 [INFO] Received command c on object id p0
2025-06-30 00:52:28,289 [ERROR] There was an exception while executing the Python Proxy on the Python Side.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/sql/utils.py", line 120, in call
    raise e
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
  File "/home/anhkhoa/spark_video_streaming/src/pipeline/spark_preprocessing.py", line 265, in process_batch
    print(f"[Batch ID: {batch_id}] Received batch with {batch_df.count()} rows")
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 1240, in count
    return int(self._jdf.count())
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.PythonException: 
  An exception was thrown from the Python worker. Please see the stack trace below.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/worker.py", line 1231, in main
    func, profiler, deserializer, serializer = read_udfs(pickleSer, infile, eval_type)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/worker.py", line 1067, in read_udfs
    udfs.append(read_single_udf(pickleSer, infile, eval_type, runner_conf, udf_index=i))
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/worker.py", line 529, in read_single_udf
    f, return_type = read_command(pickleSer, infile)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/worker.py", line 90, in read_command
    command = serializer._read_with_length(file)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/serializers.py", line 174, in _read_with_length
    return self.loads(obj)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/python/lib/pyspark.zip/pyspark/serializers.py", line 472, in loads
    return cloudpickle.loads(obj, encoding=encoding)
ModuleNotFoundError: No module named 'utils'

2025-06-30 00:52:28,518 [INFO] Closing down clientserver connection
2025-06-30 00:55:02,375 [INFO] ✅ Spark connection created successfully.
2025-06-30 00:55:04,245 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 00:55:04,270 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 00:55:04,462 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 00:55:04,487 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 00:55:04,503 [INFO] Callback Server Starting
2025-06-30 00:55:04,518 [INFO] Socket listening on ('127.0.0.1', 35767)
2025-06-30 00:55:06,134 [INFO] Python Server ready to receive messages
2025-06-30 00:55:06,134 [INFO] Received command c on object id p0
2025-06-30 00:55:54,481 [INFO] Received command c on object id p0
2025-06-30 00:56:34,030 [INFO] Received command c on object id p0
2025-06-30 00:57:56,017 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 00:57:56,030 [INFO] Closing down clientserver connection
2025-06-30 00:57:56,030 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 00:57:56,033 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 00:57:56,037 [INFO] Closing down clientserver connection
2025-06-30 00:57:56,038 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 00:57:56,038 [INFO] Closing down clientserver connection
2025-06-30 00:57:56,124 [INFO] Closing down clientserver connection
2025-06-30 00:59:18,117 [INFO] ✅ Spark connection created successfully.
2025-06-30 00:59:20,100 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 00:59:20,130 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 00:59:20,371 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 00:59:20,415 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 00:59:20,432 [INFO] Callback Server Starting
2025-06-30 00:59:20,432 [INFO] Socket listening on ('127.0.0.1', 34119)
2025-06-30 00:59:22,190 [INFO] Python Server ready to receive messages
2025-06-30 00:59:22,191 [INFO] Received command c on object id p0
2025-06-30 00:59:29,991 [INFO] Received command c on object id p0
2025-06-30 00:59:30,965 [INFO] Received command c on object id p0
2025-06-30 00:59:31,788 [INFO] Received command c on object id p0
2025-06-30 00:59:32,636 [INFO] Received command c on object id p0
2025-06-30 00:59:33,370 [INFO] Received command c on object id p0
2025-06-30 00:59:34,087 [INFO] Received command c on object id p0
2025-06-30 00:59:34,728 [INFO] Received command c on object id p0
2025-06-30 00:59:35,430 [INFO] Received command c on object id p0
2025-06-30 00:59:36,116 [INFO] Received command c on object id p0
2025-06-30 00:59:34,369 [INFO] Received command c on object id p0
2025-06-30 00:59:35,061 [INFO] Received command c on object id p0
2025-06-30 00:59:35,656 [INFO] Received command c on object id p0
2025-06-30 00:59:36,410 [INFO] Received command c on object id p0
2025-06-30 00:59:37,058 [INFO] Received command c on object id p0
2025-06-30 00:59:37,731 [INFO] Received command c on object id p0
2025-06-30 00:59:38,385 [INFO] Received command c on object id p0
2025-06-30 00:59:39,250 [INFO] Received command c on object id p0
2025-06-30 00:59:39,943 [INFO] Received command c on object id p0
2025-06-30 00:59:42,364 [INFO] Received command c on object id p0
2025-06-30 00:59:43,115 [INFO] Received command c on object id p0
2025-06-30 00:59:43,872 [INFO] Received command c on object id p0
2025-06-30 00:59:44,528 [INFO] Received command c on object id p0
2025-06-30 00:59:45,209 [INFO] Received command c on object id p0
2025-06-30 00:59:45,915 [INFO] Received command c on object id p0
2025-06-30 00:59:46,529 [INFO] Received command c on object id p0
2025-06-30 00:59:47,220 [INFO] Received command c on object id p0
2025-06-30 00:59:47,840 [INFO] Received command c on object id p0
2025-06-30 00:59:48,449 [INFO] Received command c on object id p0
2025-06-30 00:59:49,166 [INFO] Received command c on object id p0
2025-06-30 00:59:49,776 [INFO] Received command c on object id p0
2025-06-30 00:59:50,603 [INFO] Received command c on object id p0
2025-06-30 00:59:51,341 [INFO] Received command c on object id p0
2025-06-30 00:59:51,993 [INFO] Received command c on object id p0
2025-06-30 00:59:52,700 [INFO] Received command c on object id p0
2025-06-30 00:59:53,324 [INFO] Received command c on object id p0
2025-06-30 00:59:53,935 [INFO] Received command c on object id p0
2025-06-30 00:59:54,607 [INFO] Received command c on object id p0
2025-06-30 00:59:55,232 [INFO] Received command c on object id p0
2025-06-30 00:59:55,803 [INFO] Received command c on object id p0
2025-06-30 00:59:56,388 [INFO] Received command c on object id p0
2025-06-30 00:59:56,987 [INFO] Received command c on object id p0
2025-06-30 00:59:57,577 [INFO] Received command c on object id p0
2025-06-30 00:59:58,112 [INFO] Received command c on object id p0
2025-06-30 00:59:58,737 [INFO] Received command c on object id p0
2025-06-30 00:59:59,290 [INFO] Received command c on object id p0
2025-06-30 00:59:59,820 [INFO] Received command c on object id p0
2025-06-30 01:00:00,408 [INFO] Received command c on object id p0
2025-06-30 01:00:00,923 [INFO] Received command c on object id p0
2025-06-30 01:00:01,527 [INFO] Received command c on object id p0
2025-06-30 01:00:02,069 [INFO] Received command c on object id p0
2025-06-30 01:00:02,624 [INFO] Received command c on object id p0
2025-06-30 01:00:03,195 [INFO] Received command c on object id p0
2025-06-30 01:00:03,806 [INFO] Received command c on object id p0
2025-06-30 01:00:04,184 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 01:00:04,185 [INFO] Closing down clientserver connection
2025-06-30 01:00:04,185 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 01:00:04,187 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 01:00:04,187 [INFO] Closing down clientserver connection
2025-06-30 01:00:04,188 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 01:00:04,188 [INFO] Closing down clientserver connection
2025-06-30 01:00:04,207 [INFO] Closing down clientserver connection
2025-06-30 01:02:07,515 [INFO] ✅ Spark connection created successfully.
2025-06-30 01:02:09,240 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 01:02:09,277 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 01:02:09,483 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 01:02:09,509 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 01:02:09,527 [INFO] Callback Server Starting
2025-06-30 01:02:09,528 [INFO] Socket listening on ('127.0.0.1', 42313)
2025-06-30 01:02:10,953 [INFO] Python Server ready to receive messages
2025-06-30 01:02:10,953 [INFO] Received command c on object id p0
2025-06-30 01:02:38,611 [INFO] Received command c on object id p0
2025-06-30 01:02:48,875 [INFO] Received command c on object id p0
2025-06-30 01:02:56,976 [INFO] Received command c on object id p0
2025-06-30 01:03:05,116 [INFO] Received command c on object id p0
2025-06-30 01:03:12,502 [INFO] Received command c on object id p0
2025-06-30 01:03:21,027 [INFO] Received command c on object id p0
2025-06-30 01:03:30,197 [INFO] Received command c on object id p0
2025-06-30 01:03:34,928 [INFO] Received command c on object id p0
2025-06-30 01:03:43,268 [INFO] Received command c on object id p0
2025-06-30 01:03:52,320 [INFO] Received command c on object id p0
2025-06-30 01:04:02,216 [INFO] Received command c on object id p0
2025-06-30 01:04:06,983 [INFO] Received command c on object id p0
2025-06-30 01:04:14,073 [INFO] Received command c on object id p0
2025-06-30 01:04:22,768 [INFO] Received command c on object id p0
2025-06-30 01:04:31,375 [INFO] Received command c on object id p0
2025-06-30 01:04:37,855 [INFO] Received command c on object id p0
2025-06-30 01:04:46,088 [INFO] Received command c on object id p0
2025-06-30 01:04:54,779 [INFO] Received command c on object id p0
2025-06-30 01:04:57,172 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 01:04:57,203 [INFO] Closing down clientserver connection
2025-06-30 01:04:57,204 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 01:04:57,207 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 01:04:57,213 [INFO] Closing down clientserver connection
2025-06-30 01:04:57,213 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 01:04:57,214 [INFO] Closing down clientserver connection
2025-06-30 01:04:57,399 [INFO] Closing down clientserver connection
2025-06-30 13:25:26,057 [INFO] ✅ Spark connection created successfully.
2025-06-30 13:25:25,572 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 13:25:25,622 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 13:25:26,159 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 13:25:27,421 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 13:25:27,443 [INFO] Callback Server Starting
2025-06-30 13:25:27,443 [INFO] Socket listening on ('127.0.0.1', 44593)
2025-06-30 13:25:29,734 [INFO] Python Server ready to receive messages
2025-06-30 13:25:29,735 [INFO] Received command c on object id p0
2025-06-30 13:35:37,520 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 13:35:37,707 [INFO] Closing down clientserver connection
2025-06-30 13:35:37,711 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 13:35:37,725 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 13:35:37,734 [INFO] Closing down clientserver connection
2025-06-30 13:35:37,734 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 13:35:37,735 [INFO] Closing down clientserver connection
2025-06-30 13:35:38,591 [INFO] Closing down clientserver connection
2025-06-30 15:14:00,556 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:14:02,542 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:14:02,575 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:14:02,811 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:14:03,377 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:14:03,393 [INFO] Callback Server Starting
2025-06-30 15:14:03,398 [INFO] Socket listening on ('127.0.0.1', 43089)
2025-06-30 15:14:20,630 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 15:14:20,633 [INFO] Closing down clientserver connection
2025-06-30 15:14:20,633 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:14:20,635 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 15:14:20,639 [INFO] Closing down clientserver connection
2025-06-30 15:14:20,639 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:14:20,640 [INFO] Closing down clientserver connection
2025-06-30 15:14:20,688 [INFO] Closing down clientserver connection
2025-06-30 15:14:41,155 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:14:43,074 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:14:43,103 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:14:43,290 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:14:43,813 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:14:43,829 [INFO] Callback Server Starting
2025-06-30 15:14:43,829 [INFO] Socket listening on ('127.0.0.1', 40349)
2025-06-30 15:17:03,085 [INFO] Closing down clientserver connection
2025-06-30 15:23:01,817 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:23:04,106 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:23:04,138 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:23:04,362 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:23:04,897 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:23:04,918 [INFO] Callback Server Starting
2025-06-30 15:23:04,919 [INFO] Socket listening on ('127.0.0.1', 34369)
2025-06-30 15:23:07,165 [INFO] Python Server ready to receive messages
2025-06-30 15:23:07,165 [INFO] Received command c on object id p0
2025-06-30 15:23:13,133 [INFO] Received command c on object id p0
2025-06-30 15:23:14,039 [INFO] Received command c on object id p0
2025-06-30 15:23:15,286 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 15:23:15,289 [INFO] Closing down clientserver connection
2025-06-30 15:23:15,289 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:23:15,291 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 15:23:15,294 [INFO] Closing down clientserver connection
2025-06-30 15:23:15,294 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:23:15,294 [INFO] Closing down clientserver connection
2025-06-30 15:23:15,350 [INFO] Closing down clientserver connection
2025-06-30 15:27:00,246 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:27:02,136 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:27:02,161 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:27:02,361 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:27:02,861 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:27:02,884 [INFO] Callback Server Starting
2025-06-30 15:27:02,885 [INFO] Socket listening on ('127.0.0.1', 34811)
2025-06-30 15:27:04,378 [INFO] Python Server ready to receive messages
2025-06-30 15:27:04,378 [INFO] Received command c on object id p0
2025-06-30 15:27:20,881 [INFO] Received command c on object id p0
2025-06-30 15:27:22,502 [INFO] Received command c on object id p0
2025-06-30 15:27:24,397 [INFO] Received command c on object id p0
2025-06-30 15:27:25,948 [INFO] Received command c on object id p0
2025-06-30 15:27:27,265 [INFO] Received command c on object id p0
2025-06-30 15:27:28,606 [INFO] Received command c on object id p0
2025-06-30 15:27:27,408 [INFO] Received command c on object id p0
2025-06-30 15:27:28,704 [INFO] Received command c on object id p0
2025-06-30 15:27:30,080 [INFO] Received command c on object id p0
2025-06-30 15:27:31,345 [INFO] Received command c on object id p0
2025-06-30 15:27:32,700 [INFO] Received command c on object id p0
2025-06-30 15:27:33,953 [INFO] Received command c on object id p0
2025-06-30 15:27:35,057 [INFO] Received command c on object id p0
2025-06-30 15:27:36,207 [INFO] Received command c on object id p0
2025-06-30 15:27:37,354 [INFO] Received command c on object id p0
2025-06-30 15:27:38,533 [INFO] Received command c on object id p0
2025-06-30 15:27:39,655 [INFO] Received command c on object id p0
2025-06-30 15:27:40,873 [INFO] Received command c on object id p0
2025-06-30 15:27:42,113 [INFO] Received command c on object id p0
2025-06-30 15:27:43,267 [INFO] Received command c on object id p0
2025-06-30 15:27:44,438 [INFO] Received command c on object id p0
2025-06-30 15:27:45,557 [INFO] Received command c on object id p0
2025-06-30 15:27:46,762 [INFO] Received command c on object id p0
2025-06-30 15:27:46,938 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 15:27:46,972 [INFO] Closing down clientserver connection
2025-06-30 15:27:46,974 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:27:46,978 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 15:27:46,983 [INFO] Closing down clientserver connection
2025-06-30 15:27:46,984 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:27:46,984 [INFO] Closing down clientserver connection
2025-06-30 15:27:47,153 [INFO] Closing down clientserver connection
2025-06-30 15:35:26,107 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:35:28,502 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:35:28,536 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:35:28,819 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:35:27,550 [WARNING] Clock skew detected: current tick (1751272527550140) was 1360022 microseconds behind the last generated timestamp (1751272528910162), returned timestamps will be artificially incremented to guarantee monotonicity.
2025-06-30 15:35:27,805 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:35:27,835 [INFO] Callback Server Starting
2025-06-30 15:35:27,836 [INFO] Socket listening on ('127.0.0.1', 35001)
2025-06-30 15:35:30,317 [INFO] Python Server ready to receive messages
2025-06-30 15:35:30,317 [INFO] Received command c on object id p0
2025-06-30 15:35:37,991 [INFO] Received command c on object id p0
2025-06-30 15:35:38,964 [INFO] Received command c on object id p0
2025-06-30 15:35:39,751 [INFO] Received command c on object id p0
2025-06-30 15:35:40,208 [INFO] Received command c on object id p0
2025-06-30 15:35:40,702 [INFO] Received command c on object id p0
2025-06-30 15:35:41,169 [INFO] Received command c on object id p0
2025-06-30 15:35:41,567 [INFO] Received command c on object id p0
2025-06-30 15:35:42,032 [INFO] Received command c on object id p0
2025-06-30 15:35:42,415 [INFO] Received command c on object id p0
2025-06-30 15:35:42,874 [INFO] Received command c on object id p0
2025-06-30 15:35:43,166 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 15:35:43,172 [INFO] Closing down clientserver connection
2025-06-30 15:35:43,173 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:35:43,176 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 15:35:43,179 [INFO] Closing down clientserver connection
2025-06-30 15:35:43,179 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:35:43,180 [INFO] Closing down clientserver connection
2025-06-30 15:35:43,232 [INFO] Closing down clientserver connection
2025-06-30 15:37:41,550 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:37:43,492 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:37:43,523 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:37:43,733 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:37:44,002 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:37:44,020 [INFO] Callback Server Starting
2025-06-30 15:37:44,020 [INFO] Socket listening on ('127.0.0.1', 40471)
2025-06-30 15:37:45,501 [INFO] Python Server ready to receive messages
2025-06-30 15:37:45,501 [INFO] Received command c on object id p0
2025-06-30 15:43:03,225 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:43:05,441 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:43:05,470 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:43:05,645 [WARNING] [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3577, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
2025-06-30 15:43:05,648 [ERROR] Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1740, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3543, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3588, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})
2025-06-30 15:43:05,648 [ERROR] Could not create cassandra connection due to ('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})
2025-06-30 15:43:05,648 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:43:05,666 [INFO] Callback Server Starting
2025-06-30 15:43:05,667 [INFO] Socket listening on ('127.0.0.1', 43385)
2025-06-30 15:43:10,169 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 15:43:10,177 [INFO] Closing down clientserver connection
2025-06-30 15:43:10,177 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:43:10,178 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 15:43:10,181 [INFO] Closing down clientserver connection
2025-06-30 15:43:10,181 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:43:10,182 [INFO] Closing down clientserver connection
2025-06-30 15:43:10,199 [INFO] Closing down clientserver connection
2025-06-30 15:44:32,992 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:44:35,048 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:44:35,088 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:44:35,390 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:44:36,016 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:44:36,038 [INFO] Callback Server Starting
2025-06-30 15:44:36,038 [INFO] Socket listening on ('127.0.0.1', 36497)
2025-06-30 15:44:38,309 [INFO] Python Server ready to receive messages
2025-06-30 15:44:38,309 [INFO] Received command c on object id p0
2025-06-30 15:45:19,308 [INFO] Received command c on object id p0
2025-06-30 15:45:32,725 [INFO] Received command c on object id p0
2025-06-30 15:45:54,684 [INFO] Received command c on object id p0
2025-06-30 15:47:46,681 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 15:47:47,000 [INFO] Closing down clientserver connection
2025-06-30 15:47:47,105 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:47:47,197 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 15:47:47,280 [INFO] Closing down clientserver connection
2025-06-30 15:47:47,281 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 15:47:47,289 [INFO] Closing down clientserver connection
2025-06-30 15:50:38,105 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:50:40,224 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:50:40,256 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:50:40,518 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:50:44,733 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:50:44,765 [INFO] Callback Server Starting
2025-06-30 15:50:44,765 [INFO] Socket listening on ('127.0.0.1', 41333)
2025-06-30 15:50:46,528 [INFO] Python Server ready to receive messages
2025-06-30 15:50:46,528 [INFO] Received command c on object id p0
2025-06-30 15:53:44,186 [WARNING] Heartbeat failed for connection (140525976682400) to 127.0.0.1:9042
2025-06-30 15:53:44,292 [WARNING] Host 127.0.0.1:9042 has been marked down
2025-06-30 15:53:44,426 [WARNING] [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3577, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 852, in cassandra.connection.Connection.factory
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/cassandra/io/libevreactor.py", line 350, in handle_read
    buf = self._socket.recv(self.in_buffer_size)
ConnectionResetError: [Errno 104] Connection reset by peer
2025-06-30 15:58:16,883 [INFO] ✅ Spark connection created successfully.
2025-06-30 15:58:18,938 [INFO] ✅ Selection dataframe created from Kafka stream
2025-06-30 15:58:18,968 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-06-30 15:58:19,212 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-06-30 15:58:19,865 [INFO] ⚡ Streaming started with feature extraction...
2025-06-30 15:58:19,900 [INFO] Callback Server Starting
2025-06-30 15:58:19,901 [INFO] Socket listening on ('127.0.0.1', 43275)
2025-06-30 16:00:08,937 [INFO] Python Server ready to receive messages
2025-06-30 16:00:08,939 [INFO] Received command c on object id p0
2025-06-30 16:00:47,899 [INFO] Received command c on object id p0
2025-06-30 16:01:00,618 [INFO] Received command c on object id p0
2025-06-30 16:01:10,609 [INFO] Received command c on object id p0
2025-06-30 16:01:23,649 [INFO] Received command c on object id p0
2025-06-30 16:01:35,553 [INFO] Received command c on object id p0
2025-06-30 16:01:46,577 [INFO] Received command c on object id p0
2025-06-30 16:01:59,207 [INFO] Received command c on object id p0
2025-06-30 16:02:11,122 [INFO] Received command c on object id p0
2025-06-30 16:02:24,017 [INFO] Received command c on object id p0
2025-06-30 16:02:34,275 [INFO] Received command c on object id p0
2025-06-30 16:02:47,930 [INFO] Received command c on object id p0
2025-06-30 16:02:58,738 [INFO] Received command c on object id p0
2025-06-30 16:03:07,393 [INFO] Received command c on object id p0
2025-06-30 16:03:20,157 [INFO] Received command c on object id p0
2025-06-30 16:03:33,869 [INFO] Received command c on object id p0
2025-06-30 16:03:46,145 [INFO] Received command c on object id p0
2025-06-30 16:04:00,057 [INFO] Received command c on object id p0
2025-06-30 16:04:10,706 [INFO] Received command c on object id p0
2025-06-30 16:04:25,400 [INFO] Received command c on object id p0
2025-06-30 16:04:34,687 [INFO] Received command c on object id p0
2025-06-30 16:04:41,467 [INFO] Received command c on object id p0
2025-06-30 16:04:56,287 [INFO] Received command c on object id p0
2025-06-30 16:05:08,276 [INFO] Received command c on object id p0
2025-06-30 16:05:23,622 [INFO] Received command c on object id p0
2025-06-30 16:05:35,997 [INFO] Received command c on object id p0
2025-06-30 16:05:49,388 [INFO] Received command c on object id p0
2025-06-30 16:06:01,778 [INFO] Received command c on object id p0
2025-06-30 16:06:14,753 [INFO] Received command c on object id p0
2025-06-30 16:06:28,843 [INFO] Received command c on object id p0
2025-06-30 16:06:37,288 [INFO] Received command c on object id p0
2025-06-30 16:06:52,212 [INFO] Received command c on object id p0
2025-06-30 16:07:05,567 [INFO] Received command c on object id p0
2025-06-30 16:07:17,960 [INFO] Received command c on object id p0
2025-06-30 16:07:28,042 [INFO] Received command c on object id p0
2025-06-30 16:07:37,345 [INFO] Received command c on object id p0
2025-06-30 16:07:51,609 [INFO] Received command c on object id p0
2025-06-30 16:08:03,419 [INFO] Received command c on object id p0
2025-06-30 16:08:16,176 [INFO] Received command c on object id p0
2025-06-30 16:08:33,045 [INFO] Received command c on object id p0
2025-06-30 16:08:48,679 [INFO] Received command c on object id p0
2025-06-30 16:09:01,024 [INFO] Received command c on object id p0
2025-06-30 16:09:10,097 [INFO] Received command c on object id p0
2025-06-30 16:09:24,127 [INFO] Received command c on object id p0
2025-06-30 16:09:32,459 [INFO] Received command c on object id p0
2025-06-30 16:09:44,549 [INFO] Received command c on object id p0
2025-06-30 16:09:57,964 [INFO] Received command c on object id p0
2025-06-30 16:10:07,938 [INFO] Received command c on object id p0
2025-06-30 16:10:21,105 [INFO] Received command c on object id p0
2025-06-30 16:10:32,367 [INFO] Received command c on object id p0
2025-06-30 16:10:45,339 [INFO] Received command c on object id p0
2025-06-30 16:10:59,689 [INFO] Received command c on object id p0
2025-06-30 16:11:12,175 [INFO] Received command c on object id p0
2025-06-30 16:11:26,375 [INFO] Received command c on object id p0
2025-06-30 16:11:35,016 [INFO] Received command c on object id p0
2025-06-30 16:11:44,841 [INFO] Received command c on object id p0
2025-06-30 16:11:56,711 [INFO] Received command c on object id p0
2025-06-30 16:12:08,593 [INFO] Received command c on object id p0
2025-06-30 16:12:19,624 [INFO] Received command c on object id p0
2025-06-30 16:12:29,871 [INFO] Received command c on object id p0
2025-06-30 16:12:43,291 [INFO] Received command c on object id p0
2025-06-30 16:12:55,778 [INFO] Received command c on object id p0
2025-06-30 16:13:01,925 [INFO] Received command c on object id p0
2025-06-30 16:13:10,077 [INFO] Received command c on object id p0
2025-06-30 16:13:25,484 [INFO] Received command c on object id p0
2025-06-30 16:13:35,755 [INFO] Received command c on object id p0
2025-06-30 16:13:47,895 [INFO] Received command c on object id p0
2025-06-30 16:13:59,948 [INFO] Received command c on object id p0
2025-06-30 16:14:12,871 [INFO] Received command c on object id p0
2025-06-30 16:14:24,738 [INFO] Received command c on object id p0
2025-06-30 16:14:37,813 [INFO] Received command c on object id p0
2025-06-30 16:14:51,079 [INFO] Received command c on object id p0
2025-06-30 16:15:00,244 [INFO] Received command c on object id p0
2025-06-30 16:15:13,766 [INFO] Received command c on object id p0
2025-06-30 16:15:28,305 [INFO] Received command c on object id p0
2025-06-30 16:15:38,593 [INFO] Received command c on object id p0
2025-06-30 16:15:48,661 [INFO] Received command c on object id p0
2025-06-30 16:15:59,780 [INFO] Received command c on object id p0
2025-06-30 16:16:10,909 [INFO] Received command c on object id p0
2025-06-30 16:16:24,840 [INFO] Received command c on object id p0
2025-06-30 16:16:35,685 [INFO] Received command c on object id p0
2025-06-30 16:16:51,119 [INFO] Received command c on object id p0
2025-06-30 16:17:05,118 [INFO] Received command c on object id p0
2025-06-30 16:17:15,754 [INFO] Received command c on object id p0
2025-06-30 16:17:27,019 [INFO] Received command c on object id p0
2025-06-30 16:17:38,982 [INFO] Received command c on object id p0
2025-06-30 16:17:50,369 [INFO] Received command c on object id p0
2025-06-30 16:17:58,929 [INFO] Received command c on object id p0
2025-06-30 16:18:10,526 [INFO] Received command c on object id p0
2025-06-30 16:18:21,644 [INFO] Received command c on object id p0
2025-06-30 16:18:32,301 [INFO] Received command c on object id p0
2025-06-30 16:18:44,242 [INFO] Received command c on object id p0
2025-06-30 16:18:53,509 [INFO] Received command c on object id p0
2025-06-30 16:19:02,720 [INFO] Received command c on object id p0
2025-06-30 16:19:16,195 [INFO] Received command c on object id p0
2025-06-30 16:19:25,981 [INFO] Received command c on object id p0
2025-06-30 16:19:37,248 [INFO] Received command c on object id p0
2025-06-30 16:19:44,304 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-06-30 16:19:44,492 [INFO] Closing down clientserver connection
2025-06-30 16:19:44,495 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 16:19:44,515 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-06-30 16:19:44,526 [INFO] Closing down clientserver connection
2025-06-30 16:19:44,527 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-30 16:19:44,528 [INFO] Closing down clientserver connection
2025-06-30 16:19:45,915 [INFO] Closing down clientserver connection
2025-07-01 00:47:34,687 [INFO] ✅ Spark connection created successfully.
2025-07-01 00:47:37,158 [INFO] ✅ Selection dataframe created from Kafka stream
2025-07-01 00:47:37,192 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-07-01 00:47:37,542 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-07-01 00:47:36,089 [INFO] ⚡ Streaming started with feature extraction...
2025-07-01 00:47:36,110 [INFO] Callback Server Starting
2025-07-01 00:47:36,111 [INFO] Socket listening on ('127.0.0.1', 38989)
2025-07-01 00:49:05,785 [INFO] Python Server ready to receive messages
2025-07-01 00:49:05,808 [INFO] Received command c on object id p0
2025-07-01 00:51:02,118 [WARNING] Heartbeat failed for connection (140270172779184) to 127.0.0.1:9042
2025-07-01 00:51:13,225 [WARNING] [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3577, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3654, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3651, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3753, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 140, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 163, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2518, in get_all_keyspaces
  File "cassandra/metadata.py", line 2027, in get_all_keyspaces
  File "cassandra/metadata.py", line 2715, in cassandra.metadata.SchemaParserV3._query_all
  File "cassandra/connection.py", line 1126, in cassandra.connection.Connection.wait_for_responses
  File "cassandra/connection.py", line 1124, in cassandra.connection.Connection.wait_for_responses
  File "cassandra/connection.py", line 1636, in cassandra.connection.ResponseWaiter.deliver
cassandra.OperationTimedOut: errors=None, last_host=None
2025-07-01 00:51:13,183 [WARNING] [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3577, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3654, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3651, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3753, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 140, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 163, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2518, in get_all_keyspaces
  File "cassandra/metadata.py", line 2027, in get_all_keyspaces
  File "cassandra/metadata.py", line 2715, in cassandra.metadata.SchemaParserV3._query_all
  File "cassandra/connection.py", line 1126, in cassandra.connection.Connection.wait_for_responses
  File "cassandra/connection.py", line 1124, in cassandra.connection.Connection.wait_for_responses
  File "cassandra/connection.py", line 1636, in cassandra.connection.ResponseWaiter.deliver
cassandra.OperationTimedOut: errors=None, last_host=None
2025-07-01 00:56:37,459 [INFO] ✅ Spark connection created successfully.
2025-07-01 00:56:39,445 [INFO] ✅ Selection dataframe created from Kafka stream
2025-07-01 00:56:39,482 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-07-01 00:56:39,778 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-07-01 00:56:40,335 [INFO] ⚡ Streaming started with feature extraction...
2025-07-01 00:56:40,369 [INFO] Callback Server Starting
2025-07-01 00:56:40,370 [INFO] Socket listening on ('127.0.0.1', 42391)
2025-07-01 00:56:42,796 [INFO] Python Server ready to receive messages
2025-07-01 00:56:42,796 [INFO] Received command c on object id p0
2025-07-01 00:57:16,616 [INFO] Received command c on object id p0
2025-07-01 00:57:27,014 [INFO] Received command c on object id p0
2025-07-01 00:57:38,598 [INFO] Received command c on object id p0
2025-07-01 00:57:44,485 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-07-01 00:57:44,489 [INFO] Closing down clientserver connection
2025-07-01 00:57:44,489 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-07-01 00:57:44,491 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-07-01 00:57:44,495 [INFO] Closing down clientserver connection
2025-07-01 00:57:44,495 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-07-01 00:57:44,495 [INFO] Closing down clientserver connection
2025-07-01 00:57:44,535 [INFO] Closing down clientserver connection
2025-07-01 01:19:41,517 [INFO] ✅ Spark connection created successfully.
2025-07-01 01:19:43,397 [INFO] ✅ Selection dataframe created from Kafka stream
2025-07-01 01:19:43,422 [WARNING] Cluster.__init__ called with contact_points specified, but no load_balancing_policy. In the next major version, this will raise an error; please specify a load-balancing policy. (contact_points = ['localhost'], lbp = None)
2025-07-01 01:19:43,629 [INFO] Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '127.0.0.1:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
2025-07-01 01:19:45,186 [INFO] ⚡ Streaming started with feature extraction...
2025-07-01 01:19:45,210 [INFO] Callback Server Starting
2025-07-01 01:19:45,210 [INFO] Socket listening on ('127.0.0.1', 35041)
2025-07-01 01:19:44,132 [INFO] Python Server ready to receive messages
2025-07-01 01:19:44,133 [INFO] Received command c on object id p0
2025-07-01 01:20:14,807 [INFO] Received command c on object id p0
2025-07-01 01:20:13,638 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>
2025-07-01 01:20:13,642 [INFO] Closing down clientserver connection
2025-07-01 01:20:13,642 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=4>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-07-01 01:20:13,643 [INFO] Error while receiving.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc
2025-07-01 01:20:13,646 [INFO] Closing down clientserver connection
2025-07-01 01:20:13,646 [ERROR] Exception while sending command.
Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o30.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/anhkhoa/.venv/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-07-01 01:20:13,646 [INFO] Closing down clientserver connection
2025-07-01 01:20:13,668 [INFO] Closing down clientserver connection
